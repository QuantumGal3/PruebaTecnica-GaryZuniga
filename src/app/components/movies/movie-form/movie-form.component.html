<div class="container mt-4">
  <h2>{{ isEditMode ? 'Editar Película' : 'Agregar Película' }}</h2>

  <form [formGroup]="movieForm" (ngSubmit)="onSubmit()">
    <div class="row">
      <div class="col-md-6">
        <div class="mb-3">
          <label for="title" class="form-label">Título</label>
          <input
            type="text"
            class="form-control"
            id="title"
            formControlName="title"
            [class.is-invalid]="movieForm.get('title')?.invalid && (movieForm.get('title')?.dirty || movieForm.get('title')?.touched)"
          >
          @if (movieForm.get('title')?.invalid && (movieForm.get('title')?.dirty || movieForm.get('title')?.touched)) {
            <div class="invalid-feedback">
              El título es requerido
            </div>
          }
        </div>

        <div class="mb-3">
          <label for="release_date" class="form-label">Fecha de Lanzamiento</label>
          <input
            type="date"
            class="form-control"
            id="release_date"
            formControlName="release_date"
            [class.is-invalid]="movieForm.get('release_date')?.invalid && (movieForm.get('release_date')?.dirty || movieForm.get('release_date')?.touched)"
          >
          @if (movieForm.get('release_date')?.invalid && (movieForm.get('release_date')?.dirty || movieForm.get('release_date')?.touched)) {
            <div class="invalid-feedback">
              La fecha es requerida
            </div>
          }
        </div>
      </div>

      <div class="col-md-6">
        <div class="mb-3">
          <label for="overview" class="form-label">Sinopsis</label>
          <textarea
            class="form-control"
            id="overview"
            formControlName="overview"
            rows="5"
            [class.is-invalid]="movieForm.get('overview')?.invalid && (movieForm.get('overview')?.dirty || movieForm.get('overview')?.touched)"
          ></textarea>
          @if (movieForm.get('overview')?.invalid && (movieForm.get('overview')?.dirty || movieForm.get('overview')?.touched)) {
            <div class="invalid-feedback">
              La sinopsis es requerida
            </div>
          }
        </div>
      </div>
    </div>

    <div class="d-flex justify-content-between mt-4">
      <button type="button" class="btn btn-secondary" (click)="goBack()">
        Cancelar
      </button>

      <button type="submit" class="btn btn-primary" [disabled]="movieForm.invalid || loading">
        @if (loading) {
          <span class="spinner-border spinner-border-sm"></span>
          Procesando...
        } @else {
          {{ isEditMode ? 'Actualizar' : 'Guardar' }}
        }
      </button>
    </div>
  </form>
</div>
